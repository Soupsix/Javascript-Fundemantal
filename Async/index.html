<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<script>
    // console.log(1);
    // console.log(2);
    // setTimeout(() => {
    //     console.log('Hello world');
    // }, 3000);
    // console.log(3);
    // console.log(4);

    const callback = (error, data) => {
        if (error) {
            console.error('Error:', error);
        }
        if (data) {
            console.log('Connection successfully:', data);
        }
    }

    function getTodos(id, callback) {

        return new Promise((resolve, reject) => {
            var request = new XMLHttpRequest();
            request.onreadystatechange = function () {
                if (this.readyState === 4 && request.status === 200) {
                    const data = JSON.parse(request.responseText); //String -> Object
                    const dataString = JSON.stringify(request.responseText); //Object -> String
                    resolve(data); // Resolve the promise with the data
                    // callback(undefined, data);
                    // callback(undefined, dataString);
                    // callback(undefined, request.responseText);
                }

                if (this.readyState === 4 && request.status !== 200) {
                    // callback('Error fetching data', undefined);
                    reject('Error fetching data'); // Reject the promise with an error message
                }
            };
            request.open("GET", `https://jsonplaceholder.typicode.com/todos/${id}`, true);
            request.send();
        });


    }


    getTodos(1)
    .then(data => {
        console.log('>>> Get data: ', data);
        return getTodos(2);
    }).then(data2 => {
        console.log('>>> Get data 2: ', data2);
        return getTodos(3);
    }).then(data3 => {
        console.log('>>> Get data 3: ', data3);
    })
    .catch(error => {
        console.error('Error:', error);
    });


    // getTodos(1).then(data => {
    //     console.log('>>> Get data: ', data);
    //     getTodos(2).then(data => {
    //         console.log('>>> Get data 2: ', data)
    //     })
    // }).catch(error => {
    //     console.error('Error:', error);
    // });


    // getTodos(1, (error, data ) => {
    //     if (error) {
    //         console.error('Error:', error);
    //     }
    //     if (data) {
    //         console.log('Connection successfully:', data);
    //         getTodos(2,(error, data) => {
    //             if (error) {
    //                 console.error('Error:', error);
    //             }
    //             if (data) {
    //                 console.log('Connection successfully:', data);
    //                 getTodos(3,(error, data) => {
    //                     if (error) {
    //                         console.error('Error:', error);
    //                     }
    //                     if (data) {
    //                         console.log('Connection successfully:', data);
    //                     }
    //                 });
    //             }
    //         });
    //     }
    // });

    //promise example:

    const promiseExp = () => {
        return new Promise((resolve, reject) => {
            // resolve({
            //     id: 1,
            //     name: 'Nguyễn Trường',})
            reject('Error fetching data');
        })
    }

    // promiseExp().then(data => {
    //     console.log(data);
    // })
    //     .catch(error => {
    //         console.error('Error:', error);
    //     });

</script>

<body>
    <h1>Hello world Nguyễn Trường</h1>
</body>

</html>